(function(d,e,g,b){var c="ontouchstart" in e,j=c?"touchstart":"mousedown",i=c?"touchmove":"mousemove",a=c?"touchend":"mouseup",h=c?"touchcancel":"mouseup",f=function(n){var l=Math.floor(n/3600),m=Math.floor(n%3600/60),o=Math.ceil(n%3600%60);return(l==0?"":l>0&&l.toString().length<2?"0"+l+":":l+":")+(m.toString().length<2?"0"+m:m)+":"+(o.toString().length<2?"0"+o:o)},k=function(l){var m=g.createElement("audio");return !!(m.canPlayType&&m.canPlayType("audio/"+l.split(".").pop().toLowerCase()+";").replace(/no/,""))};d.fn.audioPlayer=function(o){var o=d.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},o),l={},n={playPause:"playpause",playing:"playing",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",mute:"mute",mini:"mini"};for(var m in n){l[m]=o.classPrefix+"-"+n[m]}this.each(function(){if(d(this).prop("tagName").toLowerCase()!="audio"){return false}var t=d(this),y=t.attr("src"),w=t.get(0).getAttribute("autoplay"),w=w===""||w==="autoplay"?true:false,H=t.get(0).getAttribute("loop"),H=H===""||H==="loop"?true:false,I=false;if(typeof y==="undefined"){t.find("source").each(function(){y=d(this).attr("src");if(typeof y!=="undefined"&&k(y)){I=true;return false}})}else{if(k(y)){I=true}}var E=d('<div class="'+o.classPrefix+'">'+(I?d("<div>").append(t.eq(0).clone()).html():'<embed src="'+y+'" width="0" height="0" volume="100" autostart="'+w.toString()+'" loop="'+H.toString()+'" />')+'<div class="'+l.playPause+'" title="'+o.strPlay+'"><a href="#">'+o.strPlay+"</a></div></div>"),s=I?E.find("audio"):E.find("embed"),s=s.get(0);if(I){E.find("audio").css({width:0,height:0,visibility:"hidden"});E.append('<div class="'+l.time+" "+l.timeCurrent+'"></div><div class="'+l.bar+'"><div class="'+l.barLoaded+'"></div><div class="'+l.barPlayed+'"></div></div><div class="'+l.time+" "+l.timeDuration+'"></div><div class="'+l.volume+'"><div class="'+l.volumeButton+'" title="'+o.strVolume+'"><a href="#">'+o.strVolume+'</a></div><div class="'+l.volumeAdjust+'"><div><div></div></div></div></div>');var x=E.find("."+l.bar),p=E.find("."+l.barPlayed),F=E.find("."+l.barLoaded),B=E.find("."+l.timeCurrent),C=E.find("."+l.timeDuration),u=E.find("."+l.volumeButton),G=E.find("."+l.volumeAdjust+" > div"),r=0,v=function(J){theRealEvent=c?J.originalEvent.touches[0]:J;s.currentTime=Math.round((s.duration*(theRealEvent.pageX-x.offset().left))/x.width())},q=function(J){theRealEvent=c?J.originalEvent.touches[0]:J;s.volume=Math.abs((theRealEvent.pageY-(G.offset().top+G.height()))/G.height())},A=setInterval(function(){if(s.buffered.length>0){if(s.duration>0){F.width((s.buffered.end(0)/s.duration)*100+"%")}if(s.buffered.end(0)>=s.duration){clearInterval(A)}}},100);var D=s.volume,z=s.volume=0.111;if(Math.round(s.volume*1000)/1000==z){s.volume=D}else{E.addClass(l.noVolume)}C.html("&hellip;");B.text(f(0));s.addEventListener("loadeddata",function(){C.text(f(s.duration));G.find("div").height(s.volume*100+"%");r=s.volume});s.addEventListener("timeupdate",function(){B.text(f(s.currentTime));p.width((s.currentTime/s.duration)*100+"%")});s.addEventListener("volumechange",function(){G.find("div").height(s.volume*100+"%");if(s.volume>0&&E.hasClass(l.mute)){E.removeClass(l.mute)}if(s.volume<=0&&!E.hasClass(l.mute)){E.addClass(l.mute)}});s.addEventListener("ended",function(){E.removeClass(l.playing)});x.on(j,function(J){v(J);x.on(i,function(K){v(K)})}).on(h,function(){x.unbind(i)});u.on("click",function(){if(E.hasClass(l.mute)){E.removeClass(l.mute);s.volume=r}else{E.addClass(l.mute);r=s.volume;s.volume=0}return false});G.on(j,function(J){q(J);G.on(i,function(K){q(K)})}).on(h,function(){G.unbind(i)})}else{E.addClass(l.mini)}if(w){E.addClass(l.playing)}E.find("."+l.playPause).on("click",function(){if(E.hasClass(l.playing)){d(this).attr("title",o.strPlay).find("a").html(o.strPlay);E.removeClass(l.playing);I?s.pause():s.Stop()}else{d(this).attr("title",o.strPause).find("a").html(o.strPause);E.addClass(l.playing);I?s.play():s.Play()}return false});t.replaceWith(E)});return this}})(jQuery,window,document);